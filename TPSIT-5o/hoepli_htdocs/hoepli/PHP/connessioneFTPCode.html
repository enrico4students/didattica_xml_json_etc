<html>
<head>
<title>Esercitazione per gli studenti</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body bgcolor="#FFFFFF">
<p><font color="#0000FF"><a href="connessioneFTP.php"><img src="../images/execute.gif" width="44" height="28" border="0" align="right"></a><a href="index.html"><img src="../images/return.gif" width="41" height="30" align="right" border="0"></a></font></p>
<h3><font color="#006600">Codice sorgente del file 


 connessioneFTP.php</font></h3>
<pre><font color="#0000FF">&lt;?php<br>// tecnica PostBack per verificare se &egrave; primo accesso<br>if (isset($_POST['send_file'])){ <br>  // se &egrave; secondo accesso vengono letti i campi ricevuti dal Form<br>  $ftp_server = $_POST['ftp_server']; <br>  $porta = $_POST['port'];<br>  $username = $_POST['username']; <br>  $password = $_POST['password']; <br>  // verifica se i campi sono stati tutti compilati e validazione server<br>  if ($ftp_server != 'ftp server' &amp;&amp; $ftp_server != ''){ <br>    // validazione nome utente<br>    if ($username != 'username' &amp;&amp; $username != ''){ <br>      // validazione password<br>      if ($password != 'password' &amp;&amp; $password != ''){ <br>        // validazione nome del file da caricare<br>        if (is_uploaded_file($_FILES['file']['tmp_name'])){ <br>     	    // se tutto ok lettura nome del file con percorso completo<br>          $file = $_FILES['file']['tmp_name']; <br>	        // lettura nome del file senza percorso<br>          $new_file = $_FILES['file']['name']; <br>          // connessione via FTP <br>	        $conn = ftp_connect($ftp_server, $porta) or die ('Impossibile connettersi al server.'); <br>          // login sul server<br>          ftp_login($conn, $username, $password) or die('Username o password errati.'); <br>          // modalit&agrave; passiva <br>          ftp_pasv($conn, true); <br>          // upload del file <br>          $invia = ftp_put($conn, $new_file, $file, FTP_BINARY); <br>          // esito dell'upload <br>          echo (!$invia) ? 'Upload fallito' : 'Upload completato&lt;br&gt;'; <br>          // chiusura della connessione <br>          ftp_close($conn); <br>        }else{ <br>          echo &quot;&lt;font color=red&gt;&lt;b&gt;Inserire file&lt;/font&gt;&lt;br&gt;&quot;; <br>	      } <br>      }else{ <br>        echo &quot;&lt;font color=red&gt;&lt;b&gt;Inserire password&lt;/font&gt;&lt;br&gt;&quot;; <br>      } <br>    }else{ <br>      echo &quot;&lt;font color=red&gt;&lt;b&gt;Inserire username&lt;/font&gt;&lt;br&gt;&quot;; <br>    } <br>  }else{ <br>    echo &quot;&lt;font color=red&gt;&lt;b&gt;Inserire server ftp&lt;/font&gt;&lt;br&gt;&quot;; <br>  } <br>} <br>?&gt; <br>&lt;FORM ENCTYPE=&quot;multipart/form-data&quot; NAME=&quot;modulo_ftp ACTION=&quot;&lt;?php echo $_SERVER['PHP_SELF'];?&gt;&quot; METHOD=&quot;POST&quot;&gt; <br>&lt;TABLE WIDTH=30%&gt;&lt;TR&gt;&lt;TD&gt;Server FTP&lt;TD&gt;<br>&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;ftp_server&quot; VALUE=&quot;ftp server&quot;/&gt; <br>&lt;TR&gt;&lt;TD&gt;Porta&lt;TD&gt;<br>&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;port&quot; VALUE=&quot;21&quot;/&gt; <br>&lt;TR&gt;&lt;TD&gt;User Name&lt;TD&gt;<br>&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;username&quot; VALUE=&quot;username&quot;/&gt; <br>&lt;TR&gt;&lt;TD&gt;Password&lt;TD&gt;<br>&lt;INPUT TYPE=&quot;password&quot; NAME=&quot;password&quot; VALUE=&quot;password&quot;/&gt;<br>&lt;TR&gt;&lt;TD&gt;File da caricare&lt;TD&gt;<br>&lt;INPUT TYPE=&quot;file&quot; NAME=&quot;file&quot;/&gt; <br>&lt;TR&gt;&lt;TD&gt;<br>&lt;INPUT TYPE=&quot;submit&quot; NAME=&quot;send_file&quot; VALUE=&quot;Carica file&quot;/&gt; <br>&lt;/TABLE&gt;<br>&lt;/FORM&gt;</font></pre>
<p></p>
<pre>&nbsp;
</pre>
</body>
</html>
