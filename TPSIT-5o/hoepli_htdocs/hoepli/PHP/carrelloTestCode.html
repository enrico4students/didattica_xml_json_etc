<html>
<head>
<title>Esercitazione per gli studenti</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body bgcolor="#FFFFFF">
<p><font color="#0000FF"><a href="carrelloTest.php"><img src="../images/execute.gif" width="44" height="32" border="0" align="right"></a><a href="index.html"><img src="../images/return.gif" width="41" height="30" align="right" border="0"></a></font></p>
<h3><font color="#006600">Codice sorgente del file carrello.php e carrelloTest.php</font></h3>
<pre><font color="#0000FF">&lt;?php<br>class <font color="#FF0000">Carrello</font><br>{<em><font color="#0099FF"><br>  // definizione della propriet&agrave; articoli e quantit&agrave; come array</font></em><br>  var <font color="#009900">$articoli </font>= array();<br>  var <font color="#009900">$quantita</font> = array();   </font></pre>
<pre>  <font color="#0099FF"><em><font face="Courier New, Courier, mono">// metodo che aggiunge $n articoli di tipo $a al carrello
</font></em></font><font face="Courier New, Courier, mono">  <font color="#0000FF">function</font> aggiungi_carrello($a, $q){
<font color="#0099FF"><em>    // ottengo la lunghezza dell'array</em></font>
    $<font color="#009900">position</font> = count($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">);
    $trovato = 0;
    //ciclo di ricerca elemento nell'array
    for ($i = 0; $i &lt; count($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">); $i++){ 
      if ($this-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">[$i] == $a)  <font color="#0099FF"><em>// ctr se il prodotto &egrave; presente nel carrello</em></font>
       $trovato = 1;
    }
    if ($trovato == 1)                <font color="#0099FF">// se il prodotto &egrave; gi&agrave; presente aggiorno quantit&agrave;</font>
      $<font color="#0000FF">this</font>-&gt;aggiorna($a,$q);
    else{                             <em><font color="#0099FF">// altrimenti aggiungo il prodotto al carrello</font></em>
      $<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">[$<font color="#009900">position</font>] = $a;
      $<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">quantita</font></font><font face="Courier New, Courier, mono">[$<font color="#009900">position</font>] = $q;
    }
   }
   
<font color="#0099FF"><em>   //metodo che elimina l'articolo di nome $a</em></font>
   <font color="#0000FF">function</font> togli_carrello($a){ 
<font color="#0099FF"><em>     // variabile utilizzata per cercare posizione elemento: settata a non trovato (-1)</em></font>
     $<font color="#009900">position</font> = -1;
<font color="#0099FF"><em>     // ciclo di ricerca elemento nell'array</em></font>
     for ($i = 0; $i &lt; count($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">); $i++){ 
       if ($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">[$i] == $a) <font color="#0099FF"><em>// ctr se il prodotto &egrave; presente nel carrello</em></font>
         $<font color="#009900">position</font> = $i;              <font color="#0099FF"><em>// se trovato salvo la posizione</em></font>
     }
     if ($<font color="#009900">position</font> != -1){         <font color="#0099FF"><em>   // se trovato procedo a toglierlo </em></font>
       $cont = 0;
<font color="#0099FF"><em>       // copia negli array temporanei gli elementi eccetto quello da cancellare</em></font>
       for ($i = 0; $i &lt; count($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">); $i++){
         if ($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">[$i] != $a){
           $app_ar[$cont] = $<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">[$i];
           $app_qt[$cont] = $<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">quantita</font></font><font face="Courier New, Courier, mono">[$i];
           $cont++;
         }
       }
<font color="#0099FF"><em>       // elimino i &quot;vecchi&quot; array</em></font>
       unset($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">);
       unset($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">quantita</font></font><font face="Courier New, Courier, mono">);
<font color="#0099FF"><em>       //rimetto i valori dagli array temporanei agli array articoli e quantita</em></font>
       for ($i = 0; $i &lt; count($app_ar); $i++){
         $<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">[$i] = $app_ar[$i];
         $<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">quantita</font></font><font face="Courier New, Courier, mono">[$i] = $app_qt[$i];
       }
     }
     else 
       echo &quot;Prodotto non trovato!&lt;BR&gt;&quot;;
   }  <font color="#0099FF"><em> </em></font></font><font color="#0099FF"><em><font face="Courier New, Courier, mono">// metodo che aggiorna l'array </font></em><font face="Courier New, Courier, mono"></font></font><font face="Courier New, Courier, mono">
   
   <font color="#0000FF">function</font> aggiorna($n, $q){
     $<font color="#009900">position</font>e = -1;
     for ($i = 0; $i &lt; count($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">); $i++){
       //prelevo la posizione del prodotto nell'array
       if ($<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">[$i] == $n) 
         $<font color="#009900">position</font>e = $i;
     }
<font color="#0099FF"><em>     // aggiorno le informazioni del prodotto</em></font>
     if ($<font color="#009900">position</font>e == -1) 
       echo &quot;Prodotto non trovato!&lt;BR&gt;&quot;;
     else
       $<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">quantita</font></font><font face="Courier New, Courier, mono">[$<font color="#009900">position</font>e] = $q;
   }
   
   // metodo di stampa a video dei prodotti 
   <font color="#0000FF">function</font> stampa(){
     for ($i = 0; $i &lt; count($<font color="#0000FF">this</font>-&gt;articoli); $i++){
       echo &quot;&lt;B&gt;Articoli:&lt;/B&gt; &quot; .$<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">articoli</font></font><font face="Courier New, Courier, mono">[$i] .&quot;&lt;BR&gt;&quot;;
       echo &quot;&lt;B&gt;Quantita':&lt;/B&gt; &quot; .$<font color="#0000FF">this</font>-&gt;</font><font color="#0000FF"><font color="#009900">quantita</font></font><font face="Courier New, Courier, mono">[$i] .&quot;&lt;BR&gt;&quot;;
     }
   }</font></pre>
<pre><font face="Courier New, Courier, mono">   /*
    <font color="#0000FF">function</font> Carrello($a,$b){
     $this-&gt;aggiungi_carrello($a,$b);
   }
   */</font></pre>
<pre><font face="Courier New, Courier, mono">} // fine definizione classe
?&gt;
 </font></pre>
<pre><font color="#0000FF">// </font><font color="#006600"> carrelloTest.php</font><font color="#0000FF">
&lt;?php </font><font color="#000000" face="Courier New, Courier, mono">
  // require file che contiene la classe <br>  require_once(&quot;carrello.php&quot;);<br>  // istanza oggetto di classe Carrello<br>  $<font color="#009900">acquisti</font> = new Carrello;<br>  // invocazione metodo aggiungi carrello per aggiungere alcuni prodotti<br>  echo &quot;&lt;HR&gt;Aggiungo alcuni prodotti&lt;BR&gt;&quot;;<br>  $<font color="#009900">acquisti</font>-&gt;aggiungi_carrello(&quot;tempera&quot;,5);<br>  $<font color="#009900">acquisti</font>-&gt;aggiungi_carrello(&quot;pennello&quot;,15);<br>  $<font color="#009900">acquisti</font>-&gt;aggiungi_carrello(&quot;tempera&quot;,3);<br>  $<font color="#009900">acquisti</font>-&gt;aggiungi_carrello(&quot;pippo&quot;,999);<br>  $<font color="#009900">acquisti</font>-&gt;stampa();<br>  echo &quot;&lt;HR&gt;Cancello prodotto pippo&lt;BR&gt;&quot;;<br>  $<font color="#009900">acquisti</font>-&gt;togli_carrello(&quot;pippo&quot;);<br>  $<font color="#009900">acquisti</font>-&gt;stampa();<br>  echo &quot;&lt;HR&gt;Modifico prodotto pennello&lt;BR&gt;&quot;;<br>  $<font color="#009900">acquisti</font>-&gt;aggiorna(&quot;pennello&quot;,132);<br>  $<font color="#009900">acquisti</font>-&gt;stampa();<br></font><font color="#0000FF" face="Courier New, Courier, mono">?&gt;  
 </font><font color="#0000FF" face="Courier New, Courier, mono"></font></pre>
<p>&nbsp;</p>
</body>
</html>
